syntax = "proto3";

package notificationpb;

import "gogoproto/gogo.proto";

option (gogoproto.marshaler_all) = true;
option (gogoproto.sizer_all) = true;
option (gogoproto.unmarshaler_all) = true;
option (gogoproto.goproto_getters_all) = false;

message Email{
    repeated string to_email = 1;
    repeated string to_name = 2;
    string from_email = 3;
    string from_name = 4;
    string subject = 5;
    repeated string cc = 6;
    repeated string bcc = 7;
    string reply_to = 8;
    map<string, string> parameters = 9;
    string data_json = 11;
}

message Sms{
    repeated string to = 1;
    map<string, string> parameters = 2;
    string data_json = 4;
}

message Push{
    repeated string to = 1;
    map<string, string> parameters = 2;
    string data_json = 5;
}

message Target{
    oneof backend{
        Email email = 1;
        Sms sms = 2;
        Push push = 3;
    }
}

message Message {
    string event = 1;
    string language = 2;   
    int64 send_at = 3;
    repeated Target targets = 4;
}

message MessageTargetResponse{
    int32 type = 1;
    string data = 2;
    string target = 3;
    string driver =4;
}

message SendMessageResponse{
	int32 type = 1;
	string data = 2;
	repeated MessageTargetResponse results = 3;
}

service NotificationService {
    rpc SendMessage (Message) returns (SendMessageResponse);
}